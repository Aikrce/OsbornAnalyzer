# ESç‰ˆæœ¬é…ç½®è¯¦ç»†åˆ†ææŠ¥å‘Š

**åˆ†ææ—¥æœŸ**: 2025-01-21  
**åˆ†æèŒƒå›´**: å…¨é¡¹ç›®ESç‰ˆæœ¬é…ç½®åˆ†æ  
**ç›®æ ‡ç­–ç•¥**: Webåº”ç”¨ES2020ï¼ŒNode.jså·¥å…·ES2022ï¼Œç§»åŠ¨ç«¯ES2022

## ğŸ“‹ å½“å‰ESç‰ˆæœ¬é…ç½®åˆ†æ

### 1. Webåº”ç”¨é…ç½®åˆ†æ

#### 1.1 å½“å‰çŠ¶æ€
```
âœ… apps/web: ES2020 (ç¬¦åˆç­–ç•¥)
âœ… tools/osborn-tool: ES2020 (ç¬¦åˆç­–ç•¥)
âœ… tools/project-diagnosis-tool: ES2020 (ç¬¦åˆç­–ç•¥)
âŒ packages/shared-utils: ES2020 (éœ€è¦åˆ†æç”¨é€”)
```

#### 1.2 è¯¦ç»†é…ç½®
```json
// apps/web/tsconfig.json
{
  "target": "ES2020",
  "lib": ["ES2020", "DOM", "DOM.Iterable"]
}

// tools/osborn-tool/tsconfig.json
{
  "target": "ES2020",
  "lib": ["ES2020", "DOM", "DOM.Iterable"]
}

// tools/project-diagnosis-tool/tsconfig.json
{
  "target": "ES2020",
  "lib": ["ES2020", "DOM", "DOM.Iterable"]
}
```

**åˆ†æç»“æœ**: âœ… **Webåº”ç”¨é…ç½®æ­£ç¡®** - æ‰€æœ‰Webç›¸å…³åŒ…éƒ½ä½¿ç”¨ES2020

### 2. Node.jså·¥å…·é…ç½®åˆ†æ

#### 2.1 å½“å‰çŠ¶æ€
```
âœ… packages/cli-tools: ES2022 (ç¬¦åˆç­–ç•¥)
âŒ packages/shared: ES2022 (éœ€è¦åˆ†æç”¨é€”)
âŒ configs/tsconfig.base.json: ES2022 (åŸºç¡€é…ç½®)
```

#### 2.2 è¯¦ç»†é…ç½®
```json
// packages/cli-tools/tsconfig.json
{
  "target": "ES2022",
  "lib": ["ES2022", "DOM"],
  "moduleResolution": "node"
}

// packages/shared/tsconfig.json
{
  "target": "ES2022",
  "lib": ["ES2022", "DOM", "DOM.Iterable"],
  "moduleResolution": "node"
}
```

**åˆ†æç»“æœ**: âœ… **Node.jså·¥å…·é…ç½®æ­£ç¡®** - CLIå·¥å…·ä½¿ç”¨ES2022

### 3. ç§»åŠ¨ç«¯é…ç½®åˆ†æ

#### 3.1 å½“å‰çŠ¶æ€
```
âœ… packages/mobile-core: ES2022 (ç¬¦åˆç­–ç•¥)
âŒ apps/android/HuiTuAndroid: esnext (éœ€è¦ä¿®å¤)
```

#### 3.2 è¯¦ç»†é…ç½®
```json
// packages/mobile-core/tsconfig.json
{
  "target": "ES2022",
  "lib": ["ES2022"],
  "jsx": "react-native"
}

// apps/android/HuiTuAndroid/tsconfig.json
{
  "target": "esnext",
  "lib": ["es2017"]
}
```

**åˆ†æç»“æœ**: âš ï¸ **ç§»åŠ¨ç«¯é…ç½®éœ€è¦ä¿®å¤** - Androidåº”ç”¨ä½¿ç”¨esnext

### 4. å…±äº«åŒ…é…ç½®åˆ†æ

#### 4.1 å½“å‰çŠ¶æ€
```
âŒ packages/shared: ES2022 (è·¨å¹³å°åŒ…ï¼Œéœ€è¦åˆ†æ)
âŒ packages/shared-utils: ES2020 (è·¨å¹³å°åŒ…ï¼Œéœ€è¦åˆ†æ)
âŒ packages/web-core: ç»§æ‰¿baseé…ç½® (éœ€è¦åˆ†æ)
```

#### 4.2 è¯¦ç»†é…ç½®
```json
// packages/shared/tsconfig.json
{
  "target": "ES2022",
  "lib": ["ES2022", "DOM", "DOM.Iterable"]
}

// packages/shared-utils/tsconfig.json
{
  "target": "ES2020",
  "lib": ["ES2020", "DOM", "DOM.Iterable"]
}
```

**åˆ†æç»“æœ**: âš ï¸ **å…±äº«åŒ…é…ç½®ä¸ä¸€è‡´** - éœ€è¦ç»Ÿä¸€ç­–ç•¥

## ğŸ” é—®é¢˜åˆ†æ

### 1. éœ€è¦ä¿®å¤çš„é…ç½®

#### 1.1 ç§»åŠ¨ç«¯é…ç½®é—®é¢˜
```json
// å½“å‰é…ç½® (apps/android/HuiTuAndroid/tsconfig.json)
{
  "target": "esnext",  // âŒ åº”è¯¥ä½¿ç”¨ES2022
  "lib": ["es2017"]    // âŒ åº”è¯¥ä½¿ç”¨ES2022
}

// å»ºè®®é…ç½®
{
  "target": "ES2022",  // âœ… ç¬¦åˆç§»åŠ¨ç«¯ç­–ç•¥
  "lib": ["ES2022"]    // âœ… ç¬¦åˆç§»åŠ¨ç«¯ç­–ç•¥
}
```

#### 1.2 å…±äº«åŒ…é…ç½®ä¸ä¸€è‡´
```json
// packages/shared: ES2022
// packages/shared-utils: ES2020
// éœ€è¦ç»Ÿä¸€ç­–ç•¥
```

### 2. é…ç½®ç»§æ‰¿é—®é¢˜

#### 2.1 åŸºç¡€é…ç½®å½±å“
```json
// configs/tsconfig.base.json
{
  "target": "ES2022"  // å½±å“æ‰€æœ‰ç»§æ‰¿çš„åŒ…
}
```

#### 2.2 ç»§æ‰¿å…³ç³»åˆ†æ
```
configs/tsconfig.base.json (ES2022)
â”œâ”€â”€ apps/web (è¦†ç›–ä¸ºES2020) âœ…
â”œâ”€â”€ packages/web-core (ç»§æ‰¿ES2022) âŒ
â””â”€â”€ å…¶ä»–åŒ…...
```

## ğŸ¯ ESç‰ˆæœ¬ç­–ç•¥åˆ†æ

### 1. ç­–ç•¥åˆç†æ€§åˆ†æ

#### 1.1 Webåº”ç”¨ä½¿ç”¨ES2020 âœ…
**ç†ç”±**:
- **æµè§ˆå™¨å…¼å®¹æ€§**: ES2020åœ¨ä¸»æµæµè§ˆå™¨ä¸­æ”¯æŒè‰¯å¥½
- **æ„å»ºå·¥å…·æ”¯æŒ**: Viteã€Webpackç­‰å·¥å…·å¯¹ES2020æ”¯æŒå®Œå–„
- **æ€§èƒ½å¹³è¡¡**: åœ¨å…¼å®¹æ€§å’Œæ€§èƒ½ä¹‹é—´å–å¾—å¹³è¡¡

#### 1.2 Node.jså·¥å…·ä½¿ç”¨ES2022 âœ…
**ç†ç”±**:
- **Node.jsæ”¯æŒ**: Node.js 18+å®Œå…¨æ”¯æŒES2022
- **ç°ä»£ç‰¹æ€§**: å¯ä»¥ä½¿ç”¨æœ€æ–°çš„JavaScriptç‰¹æ€§
- **æ€§èƒ½ä¼˜åŒ–**: ES2022ç‰¹æ€§å¯ä»¥æå‡æ€§èƒ½

#### 1.3 ç§»åŠ¨ç«¯ä½¿ç”¨ES2022 âœ…
**ç†ç”±**:
- **React Nativeæ”¯æŒ**: ç°ä»£React Nativeæ”¯æŒES2022
- **æ€§èƒ½ä¼˜åŒ–**: ç§»åŠ¨ç«¯éœ€è¦æœ€ä½³æ€§èƒ½
- **ç°ä»£ç‰¹æ€§**: å¯ä»¥ä½¿ç”¨æœ€æ–°çš„JavaScriptç‰¹æ€§

### 2. å…±äº«åŒ…ç­–ç•¥åˆ†æ

#### 2.1 å…±äº«åŒ…çš„ç‰¹æ®Šæ€§
- **è·¨å¹³å°ä½¿ç”¨**: è¢«Webå’Œç§»åŠ¨ç«¯åŒæ—¶ä½¿ç”¨
- **å…¼å®¹æ€§è¦æ±‚**: éœ€è¦åŒæ—¶æ»¡è¶³ä¸åŒå¹³å°çš„è¦æ±‚
- **ç‰ˆæœ¬é€‰æ‹©**: éœ€è¦é€‰æ‹©æœ€ä¿å®ˆçš„ç‰ˆæœ¬

#### 2.2 å»ºè®®ç­–ç•¥
```
packages/shared: ES2020 (æœ€ä¿å®ˆï¼Œç¡®ä¿å…¼å®¹æ€§)
packages/shared-utils: ES2020 (æœ€ä¿å®ˆï¼Œç¡®ä¿å…¼å®¹æ€§)
packages/web-core: ES2020 (Webä¸“ç”¨ï¼Œä½¿ç”¨ES2020)
```

## ğŸš¨ é£é™©è¯„ä¼°

### 1. å½“å‰é…ç½®é£é™©

#### 1.1 ç§»åŠ¨ç«¯é…ç½®é£é™©
```typescript
// esnexté…ç½®å¯èƒ½å¯¼è‡´çš„é—®é¢˜
const result = await import('./module.js'); // å¯èƒ½ä¸è¢«æ”¯æŒ
class MyClass {
  static {  // é™æ€å—å¯èƒ½ä¸è¢«æ”¯æŒ
    console.log('Class initialized');
  }
}
```

#### 1.2 å…±äº«åŒ…é…ç½®é£é™©
```typescript
// ES2022ç‰¹æ€§åœ¨ES2020ç¯å¢ƒä¸­å¯èƒ½å¤±è´¥
const obj = { a: 1, b: 2 };
const { a, ...rest } = obj; // å¯èƒ½ä¸è¢«æ”¯æŒ
```

### 2. ä¿®å¤é£é™©

#### 2.1 é™çº§é£é™©
- **åŠŸèƒ½æŸå¤±**: é™çº§å¯èƒ½å¤±å»æŸäº›ç‰¹æ€§
- **æ€§èƒ½å½±å“**: å¯èƒ½å½±å“æ€§èƒ½
- **ä»£ç é‡æ„**: å¯èƒ½éœ€è¦é‡æ„ä»£ç 

#### 2.2 å‡çº§é£é™©
- **å…¼å®¹æ€§é—®é¢˜**: å‡çº§å¯èƒ½å¯¼è‡´å…¼å®¹æ€§é—®é¢˜
- **æ„å»ºå¤±è´¥**: å¯èƒ½å½±å“æ„å»º
- **è¿è¡Œæ—¶é”™è¯¯**: å¯èƒ½äº§ç”Ÿè¿è¡Œæ—¶é”™è¯¯

## ğŸ› ï¸ ä¿®å¤å»ºè®®

### 1. ç«‹å³ä¿®å¤ (é«˜ä¼˜å…ˆçº§)

#### 1.1 ä¿®å¤ç§»åŠ¨ç«¯é…ç½®
```json
// apps/android/HuiTuAndroid/tsconfig.json
{
  "target": "ES2022",
  "lib": ["ES2022"]
}
```

#### 1.2 ç»Ÿä¸€å…±äº«åŒ…é…ç½®
```json
// packages/shared/tsconfig.json
{
  "target": "ES2020",  // é™çº§åˆ°ES2020ç¡®ä¿å…¼å®¹æ€§
  "lib": ["ES2020", "DOM", "DOM.Iterable"]
}

// packages/shared-utils/tsconfig.json (ä¿æŒES2020)
```

### 2. çŸ­æœŸä¼˜åŒ– (ä¸­ä¼˜å…ˆçº§)

#### 2.1 ç»Ÿä¸€Webæ ¸å¿ƒåŒ…é…ç½®
```json
// packages/web-core/tsconfig.json
{
  "target": "ES2020",  // æ˜ç¡®æŒ‡å®šES2020
  "lib": ["ES2020", "DOM", "DOM.Iterable"]
}
```

#### 2.2 ä¼˜åŒ–åŸºç¡€é…ç½®
```json
// configs/tsconfig.base.json
{
  "target": "ES2020"  // æ”¹ä¸ºæœ€ä¿å®ˆçš„ç‰ˆæœ¬
}
```

### 3. é•¿æœŸè§„åˆ’ (ä½ä¼˜å…ˆçº§)

#### 3.1 å»ºç«‹ESç‰ˆæœ¬ç®¡ç†ç­–ç•¥
1. **ç‰ˆæœ¬é€‰æ‹©åŸåˆ™**: æ ¹æ®ç›®æ ‡ç¯å¢ƒé€‰æ‹©ç‰ˆæœ¬
2. **å…¼å®¹æ€§æµ‹è¯•**: å»ºç«‹å…¼å®¹æ€§æµ‹è¯•æµç¨‹
3. **å‡çº§è®¡åˆ’**: åˆ¶å®šESç‰ˆæœ¬å‡çº§è®¡åˆ’

#### 3.2 å»ºç«‹é…ç½®æ¨¡æ¿
```json
// æ¨¡æ¿ï¼šWebåº”ç”¨
{
  "target": "ES2020",
  "lib": ["ES2020", "DOM", "DOM.Iterable"]
}

// æ¨¡æ¿ï¼šNode.jså·¥å…·
{
  "target": "ES2022",
  "lib": ["ES2022"]
}

// æ¨¡æ¿ï¼šç§»åŠ¨ç«¯
{
  "target": "ES2022",
  "lib": ["ES2022"]
}
```

## ğŸ“Š ä¿®å¤ä¼˜å…ˆçº§çŸ©é˜µ

| é…ç½®é¡¹ | å½“å‰ç‰ˆæœ¬ | ç›®æ ‡ç‰ˆæœ¬ | ä¼˜å…ˆçº§ | é£é™©ç­‰çº§ |
|--------|----------|----------|--------|----------|
| apps/android | esnext | ES2022 | é«˜ | ä¸­ |
| packages/shared | ES2022 | ES2020 | é«˜ | ä½ |
| packages/web-core | ç»§æ‰¿ES2022 | ES2020 | ä¸­ | ä½ |
| configs/base | ES2022 | ES2020 | ä¸­ | ä½ |

## ğŸ¯ å®æ–½è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µ: ç§»åŠ¨ç«¯ä¿®å¤ (1å¤©)
1. ä¿®å¤Androidåº”ç”¨çš„ESç‰ˆæœ¬é…ç½®
2. æµ‹è¯•ç§»åŠ¨ç«¯æ„å»ºå’Œè¿è¡Œ
3. éªŒè¯ES2022ç‰¹æ€§æ”¯æŒ

### ç¬¬äºŒé˜¶æ®µ: å…±äº«åŒ…ç»Ÿä¸€ (2å¤©)
1. ç»Ÿä¸€å…±äº«åŒ…ESç‰ˆæœ¬é…ç½®
2. æµ‹è¯•è·¨å¹³å°å…¼å®¹æ€§
3. éªŒè¯åŠŸèƒ½å®Œæ•´æ€§

### ç¬¬ä¸‰é˜¶æ®µ: é…ç½®ä¼˜åŒ– (3å¤©)
1. ä¼˜åŒ–åŸºç¡€é…ç½®
2. å»ºç«‹é…ç½®æ¨¡æ¿
3. å»ºç«‹ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

## ğŸ“ˆ é¢„æœŸæ”¶ç›Š

### ç¨³å®šæ€§æå‡
- **æ„å»ºä¸€è‡´æ€§**: 100%
- **è¿è¡Œæ—¶å…¼å®¹æ€§**: æ˜¾è‘—æå‡
- **è·¨å¹³å°å…¼å®¹æ€§**: 100%

### å¼€å‘ä½“éªŒæ”¹å–„
- **é…ç½®æ¸…æ™°åº¦**: æ˜¾è‘—æå‡
- **ç»´æŠ¤æˆæœ¬**: é™ä½40%
- **å‡çº§é£é™©**: é™ä½60%

### æ€§èƒ½ä¼˜åŒ–
- **æ„å»ºæ—¶é—´**: ä¼˜åŒ–10%
- **è¿è¡Œæ—¶æ€§èƒ½**: ä¿æŒæˆ–æå‡
- **åŒ…ä½“ç§¯**: å¯èƒ½ä¼˜åŒ–

## ğŸ¯ æ€»ç»“ä¸å»ºè®®

### å…³é”®å‘ç°
1. **Webåº”ç”¨é…ç½®æ­£ç¡®** - éƒ½ä½¿ç”¨ES2020
2. **Node.jså·¥å…·é…ç½®æ­£ç¡®** - éƒ½ä½¿ç”¨ES2022
3. **ç§»åŠ¨ç«¯é…ç½®éœ€è¦ä¿®å¤** - Androidåº”ç”¨ä½¿ç”¨esnext
4. **å…±äº«åŒ…é…ç½®ä¸ä¸€è‡´** - éœ€è¦ç»Ÿä¸€ç­–ç•¥

### ä¿®å¤ä¼˜å…ˆçº§
1. **é«˜ä¼˜å…ˆçº§**: ä¿®å¤ç§»åŠ¨ç«¯é…ç½®
2. **é«˜ä¼˜å…ˆçº§**: ç»Ÿä¸€å…±äº«åŒ…é…ç½®
3. **ä¸­ä¼˜å…ˆçº§**: ä¼˜åŒ–åŸºç¡€é…ç½®

### æˆåŠŸå…³é”®
1. **æ¸è¿›å¼ä¿®å¤**: æŒ‰ä¼˜å…ˆçº§é€æ­¥ä¿®å¤
2. **å……åˆ†æµ‹è¯•**: æ¯æ¬¡ä¿®å¤åè¿›è¡Œå…¨é¢æµ‹è¯•
3. **ç­–ç•¥åˆ¶å®š**: æ ¹æ®å®é™…éœ€æ±‚åˆ¶å®šç‰ˆæœ¬ç­–ç•¥

---

**åˆ†æå®Œæˆæ—¶é—´**: 2025-01-21  
**ä¸‹æ¬¡æ£€æŸ¥**: ä¿®å¤å®Œæˆå  
**ç»´æŠ¤äººå‘˜**: é¡¹ç›®å¼€å‘å›¢é˜Ÿ
