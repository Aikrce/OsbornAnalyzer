<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>å¥¥æ–¯æœ¬åˆ›æ–°ä¹é—® Â· æ™ºèƒ½åˆ†æå·¥å…·</title>
    <link rel="stylesheet" href="style.css" />
    <style>
      /* iOS WebView ç‰¹æ®Šä¼˜åŒ– */
      body {
        -webkit-touch-callout: none;
        -webkit-tap-highlight-color: transparent;
        overflow-x: hidden;
      }
      
      /* åªå¯¹éè¾“å…¥å…ƒç´ ç¦ç”¨æ–‡æœ¬é€‰æ‹© */
      body *:not(input):not(textarea) {
        -webkit-user-select: none;
        user-select: none;
      }
      
      /* ç¡®ä¿è¾“å…¥æ¡†å¯ä»¥æ­£å¸¸é€‰æ‹©æ–‡æœ¬ */
      input, textarea {
        -webkit-user-select: text;
        user-select: text;
      }
      
      /* é˜²æ­¢iOSç¼©æ”¾ */
      input, textarea {
        font-size: 16px !important;
      }
      
      /* ä¼˜åŒ–iOSæ»šåŠ¨ */
      .main-page {
        -webkit-overflow-scrolling: touch;
      }
      
      /* ç§»åŠ¨ç«¯é€‚é… */
      @media (max-width: 768px) {
        .hero h1 {
          font-size: 24px;
        }
        
        .hero .sub {
          font-size: 16px;
        }
        
        .card {
          margin: 10px;
          padding: 16px;
        }
        
        .export-grid {
          grid-template-columns: 1fr;
          gap: 1px;
        }
        
        .cell {
          min-height: 150px;
          padding: 12px;
        }
        
        .cell textarea {
          min-height: 80px;
          font-size: 14px;
        }
      }
    </style>
  </head>
  <body>
    <main class="main-page">
      <header class="hero">
        <h1>å¥¥æ–¯æœ¬åˆ›æ–°ä¹é—® Â· æ™ºèƒ½åˆ†æå·¥å…·</h1>
        <p class="sub">åŸºäºAIæ·±åº¦åˆ†æï¼Œè¿ç”¨å¥¥æ–¯æœ¬æ£€æ ¸è¡¨æ³•è¿›è¡Œåˆ›æ–°æ€ç»´æ‹“å±•</p>
      </header>

      <section class="workspace">
        <div class="page-tabs">
          <div class="page-tab active" data-page="analysis">
            <span>ä¸»é¢˜åˆ†æ</span>
          </div>
          <div class="page-tab" data-page="preview">
            <span>ä¹å®«æ ¼ç¼–è¾‘</span>
          </div>
        </div>
        
        <!-- åˆ†æé¡µé¢ -->
        <div class="page active" id="analysis-page">
          <div class="analysis-container">
            <!-- è¾“å…¥é…ç½®åŒº -->
            <div class="topic-section card">
              <div class="card-header">
                <h3>é…ç½®ä¸è¾“å…¥</h3>
              </div>
              
              <div class="field">
                <label for="apiKeyInput">DeepSeek APIå¯†é’¥ï¼ˆå¯é€‰ï¼‰</label>
                <div class="input-group">
                  <input
                    id="apiKeyInput"
                    type="password"
                    placeholder="å¯é€‰ï¼šè¾“å…¥APIå¯†é’¥è·å¾—AIæ·±åº¦åˆ†æ..."
                    aria-label="DeepSeek APIå¯†é’¥è¾“å…¥æ¡†"
                  />
                  <button type="button" id="toggleApiKey" class="toggle-btn" aria-label="æ˜¾ç¤º/éšè—å¯†é’¥">
                    ğŸ‘ï¸
                  </button>
                </div>
                <small class="hint">ä¸å¡«å†™APIå¯†é’¥å°†ä½¿ç”¨æœ¬åœ°æ¡ˆä¾‹æ•°æ®åº“åˆ†æï¼Œå¡«å†™åå¯è·å¾—AIæ·±åº¦åˆ†æï¼Œå¯†é’¥å°†å®‰å…¨ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°</small>
              </div>

              <div class="field">
                <label for="topicInput">åˆ†æä¸»é¢˜</label>
                <input
                  id="topicInput"
                  type="text"
                  placeholder="ä¾‹å¦‚ï¼šæ™ºèƒ½å’–å•¡æœº / åœ¨çº¿æ•™è‚²å¹³å° / å…±äº«å•è½¦ / ç¤¾åŒºå›¢è´­..."
                />
                <small class="hint">è¾“å…¥æ‚¨æƒ³è¦è¿›è¡Œåˆ›æ–°åˆ†æçš„ä¸»é¢˜ï¼Œç³»ç»Ÿå°†è¿›è¡Œæ·±åº¦è§£æ„å’Œä¹ç»´åº¦åˆ›æ–°åˆ†æ</small>
              </div>

              <div class="actions">
                <button id="analyzeBtn" class="primary" aria-label="å¼€å§‹åˆ†æ">
                  <span class="btn-text">å¼€å§‹åˆ†æ</span>
                  <span class="loading-spinner" style="display: none;">åˆ†æä¸­...</span>
                </button>
                <button id="clearBtn" class="ghost" aria-label="æ¸…ç©ºæ‰€æœ‰å†…å®¹é‡æ–°å¼€å§‹">
                  æ¸…ç©ºé‡æ¥
                </button>
              </div>
            </div>

            <!-- å…³é”®è¯åˆ†æç»“æœåŒº -->
            <div id="keywordAnalysisCard" class="card">
              <div class="card-header">
                <h3>å…³é”®è¯æ·±åº¦åˆ†æ</h3>
                <button id="downloadKeywordBtn" class="ghost small" style="display: none;">
                  ä¸‹è½½åˆ†æå›¾
                </button>
              </div>
              <div id="keywordAnalysisResult" class="analysis-content">
                <p class="placeholder">
                  ç‚¹å‡»"å¼€å§‹åˆ†æ"è¿›è¡Œä¸»é¢˜åˆ†æ<br>
                  <small>ç³»ç»Ÿå°†åŸºäºæ¡ˆä¾‹æ•°æ®åº“è¿›è¡Œåˆ†æï¼Œå¡«å…¥APIå¯†é’¥å¯è·å¾—AIæ·±åº¦åˆ†æ</small>
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- ä¹å®«æ ¼ç¼–è¾‘é¡µé¢ -->
        <div class="page" id="preview-page">
          <div class="preview-container">
            <div class="preview-actions">
              <button id="downloadGridBtn" class="primary">
                ä¸‹è½½ä¹å®«æ ¼åˆ†æå›¾
              </button>
            </div>
            
            <!-- ç»Ÿä¸€çš„ä¹å®«æ ¼ï¼šå¯ç¼–è¾‘ä¸”å®æ—¶é¢„è§ˆ -->
            <div id="exportArea" class="export-card">
              <div class="export-header">
                <div class="title">å¥¥æ–¯æœ¬åˆ›æ–°ä¹é—®åˆ†æ</div>
                <div class="topic">åˆ†æä¸»é¢˜ï¼š<span id="topicShow">ï¼ˆæœªå¡«å†™ï¼‰</span></div>
              </div>
              
              <div class="export-grid">
                <div class="cell">
                  <h3 class="cell-title">èƒ½å¦ä»–ç”¨</h3>
                  <textarea id="t-he" data-key="he" placeholder="å…¶ä»–ç”¨é€”å’Œåº”ç”¨åœºæ™¯..."></textarea>
                </div>
                <div class="cell">
                  <h3 class="cell-title">èƒ½å¦å€Ÿç”¨</h3>
                  <textarea id="t-jie" data-key="jie" placeholder="å€Ÿé‰´å…¶ä»–é¢†åŸŸçš„åšæ³•..."></textarea>
                </div>
                <div class="cell">
                  <h3 class="cell-title">èƒ½å¦æ”¹å˜</h3>
                  <textarea id="t-gai" data-key="gai" placeholder="æ”¹å˜å½¢æ€ã€æµç¨‹ã€è§„åˆ™..."></textarea>
                </div>
                <div class="cell">
                  <h3 class="cell-title">èƒ½å¦æ‰©å¤§</h3>
                  <textarea id="t-da" data-key="da" placeholder="æ‰©å¤§è§„æ¨¡ã€åŠŸèƒ½ã€å½±å“..."></textarea>
                </div>
                <div class="cell">
                  <h3 class="cell-title">èƒ½å¦ç¼©å°</h3>
                  <textarea id="t-xiao" data-key="xiao" placeholder="ç®€åŒ–ã€ä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½..."></textarea>
                </div>
                <div class="cell">
                  <h3 class="cell-title">èƒ½å¦æ›¿ä»£</h3>
                  <textarea id="t-ti" data-key="ti" placeholder="æ›¿ä»£ææ–™ã€æ–¹æ³•ã€æŠ€æœ¯..."></textarea>
                </div>
                <div class="cell">
                  <h3 class="cell-title">èƒ½å¦è°ƒæ•´</h3>
                  <textarea id="t-tiao" data-key="tiao" placeholder="è°ƒæ•´é¡ºåºã€ç»“æ„ã€æµç¨‹..."></textarea>
                </div>
                <div class="cell">
                  <h3 class="cell-title">èƒ½å¦é¢ å€’</h3>
                  <textarea id="t-dian" data-key="dian" placeholder="é¢ å€’å…³ç³»ã€åè½¬æ€ç»´..."></textarea>
                </div>
                <div class="cell">
                  <h3 class="cell-title">èƒ½å¦åˆå¹¶</h3>
                  <textarea id="t-hebing" data-key="hebing" placeholder="åˆå¹¶ã€ç»„åˆã€è”åŠ¨..."></textarea>
                </div>
              </div>
              
              <div class="export-footer">
                <span>åŸºäºå¥¥æ–¯æœ¬æ£€æ ¸è¡¨æ³•ç”Ÿæˆ</span>
                <span id="dateShow"></span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <footer class="foot">
        <p>
          <strong>ä½¿ç”¨æç¤ºï¼š</strong>
          æ¯ä¸ªæ–‡æœ¬æ¡†ä¸€è¡Œä»£è¡¨ä¸€ä¸ªåˆ›æ–°è¦ç‚¹ Â· æ”¯æŒå®æ—¶ç¼–è¾‘ Â· å¯ä¸‹è½½é«˜æ¸…PNGå›¾ç‰‡
        </p>
      </footer>
    </main>

    <!-- ä½¿ç”¨æœ¬åœ°html2canvasåº“ -->
    <script>
      // ç®€åŒ–ç‰ˆhtml2canvasåŠŸèƒ½ï¼Œç”¨äºiOS WebView
      window.html2canvas = function(element, options) {
        return new Promise((resolve, reject) => {
          // åœ¨iOS WebViewä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä»–æ–¹å¼æ¥å®ç°æˆªå›¾åŠŸèƒ½
          // è¿™é‡Œæä¾›ä¸€ä¸ªåŸºç¡€çš„å®ç°
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          
          // è®¾ç½®canvaså°ºå¯¸
          const rect = element.getBoundingClientRect();
          canvas.width = rect.width * 2; // é«˜åˆ†è¾¨ç‡
          canvas.height = rect.height * 2;
          ctx.scale(2, 2);
          
          // ç®€å•çš„æ–‡æœ¬æ¸²æŸ“ï¼ˆå®é™…åº”ç”¨ä¸­éœ€è¦æ›´å¤æ‚çš„å®ç°ï¼‰
          ctx.fillStyle = 'white';
          ctx.fillRect(0, 0, rect.width, rect.height);
          
          ctx.fillStyle = 'black';
          ctx.font = '16px Arial';
          ctx.fillText('å¥¥æ–¯æœ¬åˆ›æ–°ä¹é—®åˆ†æ', 20, 30);
          
          resolve(canvas);
        });
      };
    </script>
    <script src="app.js"></script>
  </body>
</html>